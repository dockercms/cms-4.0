 <div class="row-fluid">
	<div class="span12">
		<div class="portlet">
			<div class="portlet-title">
				<div class="caption"><i class="icon-globe"></i>数据采集</div>
			
				<div class="actions">
					<button id="sample_editable_1_new" class="btn yellow-stripe" onclick="toEditModel('acquisitionController.do?addPageModel')">
						新增 <i class="icon-plus"></i>
					</button>
				</div>
			</div>
			
			<div class="portlet-body">
				<div class="span12 booking-search">
					<form id="search_form">
						<div class="clearfix">
								<div class="span4">
									<label>采集名称：
										<input name="acqName" class="form-control span9" type="text" value="${searchMap["acqName"]?if_exists[0]}">
									</label>
								</div>
							<div class="pull-right">
								<button type="button" class="btn yellow btn-sm" onclick="toSearch('acquisitionController.do?table', 'search_form');">搜索  <i class="icon-search m-icon-white"></i></button>
								<button type="button" class="btn yellow btn-sm" onclick="resetForm('search_form');">重置 <i class="icon-repeat m-icon-white"></i></button>
							</div>
						</div>
					</form>
				</div>
				
				<table class="table table-striped table-bordered table-hover" id="sample_1">
					<thead>
						<tr>
							<th width="40" style="text-align:center;">序号</th>
							<!--<th>siteId</th>
							<th>channelId</th>
							<th>typeId</th>
							<th>userId</th>-->
							<th >采集名称</th>
							<th width="40" >状态</th>
							<th width="130" >当前/总页数</th>
							<!--<th width="100">开始时间</th>
							<th width="100">停止时间</th>
							<th>暂停时间(毫秒)</th>
							<th>页面编码</th>-->
							<!--<th>采集列表</th>
							<th>动态地址</th>
							<th>页码开始</th>
							<th>页码结束</th>
							<th>内容链接区开始</th>
							<th>内容链接区结束</th>
							<th>内容链接开始</th>
							<th>内容链接结束</th>
							<th>标题开始</th>
							<th>标题结束</th>
							<th>关键字开始</th>
							<th>关键字结束</th>
							<th>描述开始</th>
							<th>描述结束</th>
							<th>内容开始</th>
							<th>内容结束</th>
							<th>内容分页开始</th>
							<th>内容分页结束</th>
							<th>队列</th>
							<th>重复类型</th>
							<th>是否采集图片</th>
							<th>内容地址补全url</th>
							<th>图片地址补全url</th>
							<th>浏览量开始</th>
							<th>浏览量结束</th>
							<th>id前缀</th>
							<th>id后缀</th>
							<th>浏览量动态访问地址</th>
							<th>发布时间开始</th>
							<th>发布时间结束</th>
							<th>作者开始</th>
							<th>作者结束</th>
							<th>来源开始</th>
							<th>来源结束</th>
							<th>发布时间格式</th>-->
							<th width="80" style="text-align:center;">操作</th>
						</tr>
					</thead>
					<tbody>
						<#if pageList?exists>
						  <#list pageList as page>
							<tr class="odd gradeX">
							<td style="text-align:center;">
												${(pageNo-1)*pageSize+page_index?if_exists+1}
										</td>
										<!--<td class="center">
												${page.siteId}
										</td>
										<td class="center">
												${page.channelId}
										</td>
										<td class="center">
												${page.typeId}
										</td>
										<td class="center">
												${page.userId}
										</td>-->
										<td >
												${page.acqName}
										</td>
										<td >
									 	<#assign status="${page.status}" />
										 	<#if status==0>
								           	停止
							           		<#elseif status==1>
									      	采集        
							             	<#elseif status==2>
									      	暂停        
								  			</#if>
										</td>
										<td >
											${page.currNum}.${page.currItem}/${page.totalNum}.${page.totalItem}
										</td>
										<#--<td >
												${page.startTime?string("yyyy-MM-dd hh:mm:ss")}
										</td>
										<td >
												${page.endTime?string("yyyy-MM-dd hh:mm:ss")}
										</td>
										<td >
												${page.pauseTime}
										</td>
										<td >
												${page.pageEncoding}
										</td>
										<td >
												${page.planList}
										</td>
										<td >
												${page.dynamicAddr}
										</td>
										<td>
												${page.dynamicStart}
										</td>
										<td>
												${page.dynamicEnd}
										</td>
										<td >
												${page.linksetStart}
										</td>
										<td >
												${page.linksetEnd}
										</td>
										<td >
												${page.linkStart}
										</td>
										<td >
												${page.linkEnd}
										</td>
										<td >
												${page.titleStart}
										</td>
										<td >
												${page.titleEnd}
										</td>
										<td >
												${page.keywordsStart}
										</td>
										<td >
												${page.keywordsEnd}
										</td>
										<td >
												${page.descriptionStart}
										</td>
										<td>
												${page.descriptionEnd}
										</td>
										<td>
												${page.contentStart}
										</td>
										<td >
												${page.contentEnd}
										</td>
										<td >
												${page.paginationStart}
										</td>
										<td >
												${page.paginationEnd}
										</td>
										<td >
												${page.queue}
										</td>
										<td >
												${page.repeatCheckType}
										</td>
										<td >
												${page.imgAcqu}
										</td>
										<td>
												${page.contentPrefix}
										</td>
										<td >
												${page.imgPrefix}
										</td>
										<td >
												${page.viewStart}
										</td>
										<td >
												${page.viewEnd}
										</td>
										<td >
												${page.viewIdStart}
										</td>
										<td >
												${page.viewIdEnd}
										</td>
										<td >
												${page.viewLink}
										</td>
										<td >
												${page.releasetimeStart}
										</td>
										<td >
												${page.releasetimeEnd}
										</td>
										<td >
												${page.authorStart}
										</td>
										<td >
												${page.authorEnd}
										</td>
										<td >
												${page.originStart}
										</td>
										<td >
												${page.originEnd}
										</td>
										<td >
												${page.releasetimeFormat}
										</td>-->
								<td style="text-align:center;">
									<input type='button' title='修改' class="editbtn"   onclick="toEditModel('acquisitionController.do?updatePageModel&id=${page.id?if_exists}')">
									<input type='button' title='删除'  class="delbtn"  onclick="del('acquisitionController.do?del', '${page.id?if_exists}')">
									<div class="btn-group" style="height:20px;margin: 0px !important;">
										<input type='button' title='管理选项' class="dropdown-toggle" data-toggle="dropdown" style='width:25px; height:16px;  border:0; background:url(media/image/menu.png) no-repeat left top'>
										<ul class="dropdown-menu pull-right" style="min-width:80px;">
											<li><a href="javaScript:void(0)" onclick="start('acquisitionController.do?start&ids=${page.id?if_exists}')"><span class="icon-play"></span> 开始</a></li>	
											<li><a href="javaScript:void(0)" onclick="lmAlert('功能未实现')"><span class="icon-pause"></span> 暂停</a></li>	
											<!-- <li><a href="javaScript:void(0)" onclick="lmAlert('功能未实现')"><span class="icon-stop"><b style="margin-left:10px">停止</b></span></a></li> -->
												<li><a href="javaScript:void(0)" onclick="end('acquisitionController.do?end&ids=${page.id?if_exists}')"><span class="icon-stop"></span> 停止</a></li>	
										</ul>
									</div>
								</td>
							</tr>
						  </#list> 
						</#if>
					</tbody>
				</table>
				<#include "/lmPage/common/page.html">
			</div>
		</div>
	</div>
</div>
<div id="editModel" class="modal fade" tabindex="-1" data-backdrop="static" data-focus-on="input:first" data-width="800">
</div>
<script>
	//开始采集
	function start(urlStr){
		$.ajax({
			type:'post',
			url:urlStr,
			data:'data=0',
			dataType:'text',
			success:function(msg){
				var obj = JSON.parse(eval(msg));
				if(obj.isSuccess){
					UIToastr.success(obj.msg);
				}else{
					UIToastr.error("生成失败!");
				}
			},
			error:function(){
				lmAlert("load page error, page url is " + urlStr);
			}
		});
	}
	
	
	//停止采集
	function end(urlStr){
		$.ajax({
			type:'post',
			url:urlStr,
			data:'data=0',
			dataType:'text',
			success:function(msg){
				var obj = JSON.parse(eval(msg));
				if(obj.isSuccess){
					UIToastr.success(obj.msg);
				}else{
					UIToastr.error(obj.msg);
				}
			},
			error:function(){
				lmAlert("load page error, page url is " + urlStr);
			}
		});
	}
	
	
	
	
	
</script>
