<div class="modal-header">
	<button type="button" class="close" data-dismiss="modal"
		aria-hidden="true"></button>
	<h4 class="modal-title">站点管理</h4>
</div>
		<div class="modal-body">
			<!-- BEGIN FORM-->
			<form id="form_sample_2" class="form-horizontal">
				<input type="hidden" id="id" name="id" value="${page.id?if_exists}"/>
					<div class="alert alert-error hide">
						<button class="close" data-dismiss="alert"></button>
						有未填写项或错误项. 请检查后再提交.
					</div>
					<div class="alert alert-success hide">
						<button class="close" data-dismiss="alert"></button>
						表单验证成功!
					</div>
					<#--<div class="control-group" style="padding-top: 20px;">
						<label class="control-label"><span class="required">*</span>配置ID</label>
						<div class="controls">
							<input type="text" id="configId" name="configId" class="form-control span3" data-rule-required="true" value="${page.configId?if_exists}"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">上传ftp</label>
						<div class="controls">
							<input type="text" id="ftpUploadId" name="ftpUploadId" class="form-control span3" data-rule-required="true" value="${page.ftpUploadId?if_exists}"/>
						</div>
					</div>-->
					<div class="control-group">
						<label class="control-label"><span class="required">*</span>网站名称</label>
						<div class="controls">
							<#if page.sitePath?if_exists>
								<input  type="text" id="siteName" name="siteName" class="form-control span3" data-rule-required="true" value="${page.siteName?if_exists}"/>
							<#else>
								<input onchange="pyChange('siteName')" type="text" id="siteName" name="siteName" class="form-control span3" data-rule-required="true" value="${page.siteName?if_exists}"/>
							</#if>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label"><span class="required">*</span>简短名称</label>
						<div class="controls">
							<input type="text" id="shortName" name="shortName" class="form-control span3" data-rule-required="true" value="${page.shortName?if_exists}"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label"><span class="required">*</span>域名</label>
						<div class="controls">
							<input type="text" id="domain" name="domain" class="form-control span3" data-rule-required="true" value="${page.domain?if_exists}"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label"><span class="required">*</span>路径</label>
						<div class="controls">
							<#if page.sitePath?exists>
								${page.sitePath?if_exists}
							<#else>
								<input type="text" id="sitePath" name="sitePath" onblur="checkPath(this.value)"  class="form-control span3" data-rule-required="true" />
								
							</#if>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label"><span class="required">*</span>首页模板</label>
						<div class="controls">
							<input type="text" id="tempaltepath" name="indexTemplate" <#if !page.indexTemplate?exists>readonly="readonly"</#if> class="form-control span3" data-rule-required="true" value="${page.indexTemplate!'index.html'}"/>
							<#if page.indexTemplate?exists><button class="btn purple btn-sm" type="button" onclick="toEditModel('templateController.do?tableDialog')">选择模板</button></#if>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label"><span class="required">*</span>协议</label>
						<div class="controls">
						<select id="protocol" name="protocol" class="form-control span3" data-rule-required="true" data-msg-required="请选择协议.">
							<option value="http://">http://</option>
							<option value="https://" <#if page.protocol=='https://'>selected="selected"</#if>>https://</option>
						</select>
							<!--<input type="text" id="protocol" name="protocol" class="span6 m-wrap" value="${page.protocol?if_exists}"/>
							<span class="help-inline">填写协议</span>
							!-->
						</div>
					</div>
					<div class="control-group">
						<label class="control-label"><span class="required">*</span>静态页后缀</label>
						<div class="controls">
							<input type="text" id="staticSuffix" name="staticSuffix" class="form-control span3" data-rule-required="true" value="${page.staticSuffix!'.shtml'}"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">是否主站</label>
						<div class="controls">
							<label class="radio">
								<input class="m-wrap m-ctrl-medium" type="radio" name="isMaster" <#if page.isMaster=='1'||!page.isMaster?exists >checked="checked"</#if> value="1" />是
							</label>
							<label class="radio">
								<input class="m-wrap m-ctrl-medium" type="radio" name="isMaster" <#if page.isMaster=='0'>checked="checked"</#if> value="0" />否
							</label>
						</div>
					</div>
					<#--
					<div class="control-group">
						<label class="control-label">终审级别</label>
						<div class="controls">
							<select name="finalStep" style="width:50px;">
								<option value="1" <#if page.finalStep==1>selected="selected"</#if>>1</option>
								<option value="2" <#if page.finalStep==2 || !(page.finalStep?exists) >selected="selected"</#if>>2</option>
								<option value="3" <#if page.finalStep==3>selected="selected"</#if>>3</option>
							</select>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">审核后</label>
						<div class="controls">
							<label class="radio">
								<input class="m-wrap m-ctrl-medium" type="radio" name="afterCheck" <#if page.afterCheck=='1'||!page.afterCheck?exists >checked="checked"</#if> value="1" />不能修改删除
							</label>
							<label class="radio">
								<input class="m-wrap m-ctrl-medium" type="radio" name="afterCheck" <#if page.afterCheck=='2'>checked="checked"</#if> value="2" />修改后退回
							</label>
							<label class="radio">
								<input class="m-wrap m-ctrl-medium" type="radio" name="afterCheck" <#if page.afterCheck=='3'>checked="checked"</#if> value="3" />修改后不变
							</label>
						</div>
					</div>-->
					<#--<div class="control-group">
						<label class="control-label">动态页后缀</label>
						<div class="controls">
							<input type="text" id="dynamicSuffix" name="dynamicSuffix" class="form-control span3" data-rule-required="true" value="${page.dynamicSuffix?if_exists}"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">静态页存放目录</label>
						<div class="controls">
							<input type="text" id="staticDir" name="staticDir" class="form-control span3" data-rule-required="true" value="${page.staticDir?if_exists}"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">是否使用将首页放在根目录下</label>
						<div class="controls">
							<input type="text" id="isIndexToRoot" name="isIndexToRoot" class="form-control span3" data-rule-required="true" value="${page.isIndexToRoot?if_exists}"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">是否静态化首页</label>
						<div class="controls">
							<input type="text" id="isStaticIndex" name="isStaticIndex" class="form-control span3" data-rule-required="true" value="${page.isStaticIndex?if_exists}"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">后台本地化</label>
						<div class="controls">
							<input type="text" id="localeAdmin" name="localeAdmin" cclass="form-control span3" data-rule-required="true" value="${page.localeAdmin?if_exists}"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">前台本地化</label>
						<div class="controls">
							<input type="text" id="localeFront" name="localeFront" class="form-control span3" data-rule-required="true" value="${page.localeFront?if_exists}"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">模板方案</label>
						<div class="controls">
							<input type="text" id="tplSolution" name="tplSolution" class="form-control span3" data-rule-required="true" value="${page.tplSolution?if_exists}"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">是否使用相对路径</label>
						<div class="controls">
							<input type="text" id="isRelativePath" name="isRelativePath" class="form-control span3" data-rule-required="true" value="${page.isRelativePath?if_exists}"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">是否开启回收站</label>
						<div class="controls">
							<input type="text" id="isRecycleOn" name="isRecycleOn" class="form-control span3" data-rule-required="true" value="${page.isRecycleOn?if_exists}"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">域名别名</label>
						<div class="controls">
							<input type="text" id="domainAlias" name="domainAlias" class="form-control span3" data-rule-required="true" value="${page.domainAlias?if_exists}"/>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label">域名重定向</label>
						<div class="controls">
							<input type="text" id="domainRedirect" name="domainRedirect" class="form-control span3" data-rule-required="true" value="${page.domainRedirect?if_exists}"/>
						</div>
					</div>-->
					<div class="control-group">
						<label class="control-label">是否开启Ucenter</label>
						<div class="controls">
							<label class="radio">
								<input class="m-wrap m-ctrl-medium" type="radio" name="ucenterisOpen" <#if page.ucenterisOpen=='1' >checked="checked"</#if> value="1" />是
							</label>
							<label class="radio">
								<input class="m-wrap m-ctrl-medium" type="radio" name="ucenterisOpen" <#if page.ucenterisOpen=='0'||!page.ucenterisOpen?exists>checked="checked"</#if> value="0" />否
							</label>
						</div>
					</div>
			</form>
		</div>
<div class="modal-footer">
	<input type="button" onclick="formSubmitModel2('siteController.do?save', 'form_sample_2');" class="btn btn-primary" value="提交" /> 
	<input type="button" class="btn" data-dismiss="modal" aria-hidden="true" value="关闭" />
</div>
<script>
	jQuery(document).ready(function() {   
	   // initiate layout and plugins
	   App.init();
	   $("#form_sample_2").myValidate();
	});
	
	//获取名称拼音
	function pyChange(sitename) {
		var sitePath=$("#sitePath").val();
		var siteval=$("#"+sitename).val();
			$.ajax({
				type : "POST",
				url : "siteController.do?pyChange&sitename=" + encodeURI(encodeURI(siteval)),
				dataType : "text",
				success : function(data) {
					var data = JSON.parse(eval(data));
					$("#sitePath").val(data.siteName);
				}
			});
	}
	function checkPath(path) {
		$.ajax({
			type : "POST",
			url : "siteController.do?checkPath&path=" + path,
			dataType : "text",
			success : function(data) {
				if(data=='true'){
					$("#sitePath").closest('.control-group').removeClass('success').addClass('error');
					alert("路径已经存在，请更换路径!");
				}
			}
		});
	}
	
	function formSubmitModel2(urlStr, formName){
		if(!$('#' + formName).valid()){
			return false;
	  	}
		$.ajax({
			type:'post',
			url:urlStr,
			data:$('#' + formName).serialize(),
			dataType:'text',
			success:function(msg){
				var obj = JSON.parse(eval(msg));
				lmAlert(obj.msg);
				if(obj.isSuccess){
					var toUrl = obj.toUrl;
					
					if (!toUrl && typeof(toUrl)!="undefined" && toUrl!=0 && toUrl != '')
					{
					    toUrl = arguments[2] + '';
					}
					$('#editModel2').modal('hide');
					$('#editModel2').empty();
					lazyChangePage(toUrl);
				}
			},
			error:function(){
				lmAlert("提交通讯失败!");
			}
		});
	}
</script>
<!-- END JAVASCRIPTS -->  
<div id="editModel" class="modal hide fade" tabindex="-1" data-backdrop="static" data-focus-on="input:first" data-width="800">
